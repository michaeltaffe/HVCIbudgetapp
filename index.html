<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SpendGraph Demo</title>
<style>
  /* Light theme */
  :root {
    --bg:#f7f6f2;        /* off-white */
    --card:#ffffff;      /* white cards */
    --ink:#16181d;       /* near-black text */
    --muted:#5f6b76;
    --ok:#2e7d32;        /* green */
    --warn:#f9a825;      /* yellow */
    --bad:#c62828;       /* red */
    --track:#e9edf1;     /* bar track */
    --shadow: 0 10px 30px rgba(0,0,0,.08);
    --subtle: #eef1f5;
  }

  * { box-sizing: border-box; }
  body {
    margin:0;
    font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    background:var(--bg);
    color:var(--ink);
  }
  .wrap { max-width: 840px; margin: 24px auto 120px; padding: 0 16px; }
  .card { background: var(--card); border-radius: 16px; padding: 20px; box-shadow: var(--shadow); margin-bottom: 16px; }
  h1, h2, h3 { margin: 0 0 12px; }
  .subtitle { color: var(--muted); }

  .pill { display:inline-block; padding: 4px 10px; border-radius: 999px; background:var(--subtle); color:#3b4046; font-size: 12px; margin-left:8px; }

  .controls {
    display:flex; align-items:center; gap:12px; margin-top:8px;
    background: var(--subtle); border-radius: 12px; padding:10px 12px;
  }
  .controls label { font-size: 13px; color: var(--muted); }
  .controls input[type="range"] { width: 220px; }

  .bars { display:grid; grid-template-columns: 200px 1fr; gap: 10px 16px; align-items:center; }
  .label { color:#1e2328; font-weight:600; }

  .bar { height: 22px; background:var(--track); border-radius: 8px; position: relative; overflow:hidden; }
  .fill { height:100%; border-radius:8px; transition: width .35s ease; }
  .pct { position:absolute; right:6px; top:50%; transform: translateY(-50%); font-size:12px; color:#111; mix-blend-mode: difference; }

  .hint {
    position:absolute; right:-6px; top:-34px; background:#111; color:#fff; font-size:12px;
    padding:6px 8px; border-radius:6px; box-shadow: 0 8px 18px rgba(0,0,0,.25); display:none; white-space:nowrap;
  }
  .bar.over .hint, .bar:hover .hint { display:block; }

  .events .row { display:flex; justify-content:space-between; align-items:center; background:var(--subtle); padding:10px 12px; border-radius:10px; margin:8px 0; }
  .events .title { font-weight:600; }
  .events .amt { font-weight:700; }

  .footer { position: fixed; left:0; right:0; bottom:0; background:#ffffff; border-top:1px solid #e6e6ea; padding:10px 16px; }
  .chips { display:flex; gap:14px; justify-content:center; }
  .chip { width:54px; height:54px; border:2px solid #f28e1c; border-radius:16px; opacity:.9; }
  .chip.circle { border-radius:999px; }
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>Consider <em>eating in</em> this week… <span class="pill">June 2024</span></h1>
    <div class="subtitle">Salary: $100,000 • Saving goal: $30,000 in 36 months (≈ $833.33/mo)</div>

    <!-- Interactivity: month progress scrubs how “spent” contributes to the bars -->
    <div class="controls">
      <label for="progress">Month progress:</label>
      <input id="progress" type="range" min="0" max="100" value="45" />
      <span id="progressLabel" class="pill">45%</span>
    </div>
  </div>

  <div class="card">
    <div class="bars" id="bars"></div>
  </div>

  <div class="card events">
    <h2>You have <b>4</b> events scheduled today with an expected cost of <b>$180</b>.</h2>
    <div class="subtitle">Based on envelopes, suggested cap is <b>$15.0</b> total.</div>
    <div id="events"></div>
  </div>
</div>

<div class="footer">
  <div class="chips">
    <div class="chip"></div>
    <div class="chip"></div>
    <div class="chip circle"></div>
    <div class="chip"></div>
    <div class="chip"></div>
  </div>
</div>

<script>
const DATA = {"salary": 100000, "goal_total": 30000, "goal_months": 36, "monthly_required_savings": 833.33, "annual_required_savings": 10000.0, "savings_rate_assumed": 0.1, "month_label": "June 2024", "categories": [{"category": "Auto & Gas", "baseline": -59.05, "elasticity": 1.0, "cut": 6.7669999999999915, "envelope": 0.0, "spent": -17.4, "pct": 0, "remaining": 17.4}, {"category": "Home Improvements", "baseline": -2319.98, "elasticity": 1.0, "cut": 6.7669999999999915, "envelope": 0.0, "spent": 0.0, "pct": 0, "remaining": 0.0}, {"category": "Paycheck", "baseline": 3892.365, "elasticity": 1.0, "cut": 6.7669999999999915, "envelope": 3885.6, "spent": 0.0, "pct": 0, "remaining": 3885.6}, {"category": "Subscriptions", "baseline": -87.88, "elasticity": 0.6, "cut": 4.060199999999995, "envelope": 0.0, "spent": -27.49, "pct": 0, "remaining": 27.49}, {"category": "Transfer", "baseline": -270.5, "elasticity": 1.0, "cut": 6.7669999999999915, "envelope": 0.0, "spent": 0.0, "pct": 0, "remaining": 0.0}, {"category": "Travel", "baseline": -5.8, "elasticity": 1.0, "cut": 6.7669999999999915, "envelope": 0.0, "spent": 0.0, "pct": 0, "remaining": 0.0}, {"category": "Utilities", "baseline": -266.1, "elasticity": 0.4, "cut": 2.7067999999999968, "envelope": 0.0, "spent": 0.0, "pct": 0, "remaining": 0.0}, {"category": "nan", "baseline": -409.365, "elasticity": 1.0, "cut": 6.7669999999999915, "envelope": 0.0, "spent": -622.15, "pct": 0, "remaining": 622.15}], "events_today": [{"title": "Dinner with Jim", "category": "Restaurants/Bars", "expected": 65, "cap": 0.0}, {"title": "Goose Concert", "category": "Entertainment", "expected": 70, "cap": 0.0}, {"title": "Drinks with Julia", "category": "Restaurants/Bars", "expected": 30, "cap": 0.0}, {"title": "Yoga Class", "category": "Subscriptions", "expected": 15, "cap": 15}], "events_expected_sum": 180, "events_capped_sum": 15.0};

const $bars = document.getElementById('bars');
const $progress = document.getElementById('progress');
const $progressLabel = document.getElementById('progressLabel');

/* Color logic stays the same */
function colorFor(pct) {
  if (pct < 70) return 'var(--ok)';
  if (pct < 100) return 'var(--warn)';
  return 'var(--bad)';
}

function fmt(x){ return '$' + (Math.round(x*100)/100).toLocaleString(); }

/* Compute percent from spent/envelope and a “month progress” factor */
function computePct(cat, factor) {
  const env = Math.abs(cat.envelope || 0);
  const spent = Math.abs(cat.spent || 0) * (factor/100); // scale by slider
  if (env <= 0) return 0;
  r

renderBars();
renderEvents();
</script>
</body>
</html>
